/*! bandjo - v1.0.0 - 06-21-2016 */var ObjectId=require("mongodb").ObjectId,crypto=require("crypto");exports.loginUser=function(a,b){var c=a.body.email,d=a.body.password,e=crypto.createHash("sha1").update(d).digest("hex"),f={email:c,password:e},g={_id:1};a.db.collection("users").findOne(f,g,function(c,d){c?b.send(c):null==d?b.send("0"):(a.session.userID=d._id,b.locals.loggedUserID=d._id,b.json(d))})},exports.logoutUser=function(a,b){a.session=null,b.locals.loggedUserID=null,b.status(200).send("Success")},exports.getUser=function(a,b){var c=a.query.id,d=a.query.url,e=a.query.email;console.log("User lookup values: id="+c+", url="+d+", email="+e);var f={};c?f={_id:new ObjectId(c)}:d?f={link:d}:e&&(f={email:e});var g={password:0};a.db.collection("users").findOne(f,g,function(a,c){a?b("error"):b.json(c)})},exports.getUserByURL=function(a,b){var c=a.params.link;console.log("Getting user by url "+c);var d={link:c},e={password:0};a.db.collection("users").findOne(d,e,function(a,c){a?b("error"):b.json(c)})},exports.getUsers=function(a,b){if(a.query.genre){a.query.genre.split(",")}if(a.query.influence){a.query.influence.split(",")}if(a.query.instrument){a.query.instrument.split(",")}b.status(200).send("Success")},exports.updateUserByID=function(a,b){var c=a.params.id;({_id:new Object(c)})},exports.createUser=function(a,b){a.db.collection("users").insertOne(b,function(a,b){})};var ObjectId=require("mongodb").ObjectId,crypto=require("crypto");exports.loginUser=function(a,b){var c=a.body.email,d=a.body.password,e=crypto.createHash("sha1").update(d).digest("hex"),f={email:c,password:e},g={_id:1};a.db.collection("users").findOne(f,g,function(c,d){c?b.send(c):null==d?b.send("0"):(a.session.userID=d._id,b.locals.loggedUserID=d._id,b.json(d))})},exports.logoutUser=function(a,b){a.session=null,b.locals.loggedUserID=null,b.status(200).send("Success")},exports.getUser=function(a,b){var c=a.query.id,d=a.query.url,e=a.query.email;console.log("User lookup values: id="+c+", url="+d+", email="+e);var f={};c?f={_id:new ObjectId(c)}:d?f={link:d}:e&&(f={email:e});var g={password:0};a.db.collection("users").findOne(f,g,function(a,c){a?b("error"):b.json(c)})},exports.getUserByURL=function(a,b){var c=a.params.link;console.log("Getting user by url "+c);var d={link:c},e={password:0};a.db.collection("users").findOne(d,e,function(a,c){a?b("error"):b.json(c)})},exports.getUsers=function(a,b){a.query.genre&&a.query.genre.split(","),a.query.influence&&a.query.influence.split(","),a.query.instrument&&a.query.instrument.split(","),b.status(200).send("Success")},exports.updateUserByID=function(a,b){var c=a.params.id;({_id:new Object(c)})},exports.createUser=function(a,b){a.db.collection("users").insertOne(b,function(a,b){})};